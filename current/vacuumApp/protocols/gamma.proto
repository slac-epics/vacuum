# Stream Device Protocol for the MKS 937A Multi-Sensor System
Terminator   = CR;
ReadTimeout = 100; # milliseconds
Extrainput   = Ignore;
Channel = 0x30+\$1;
Addr = 05;

# cmd packet
# <start><space><addr><space><cmd><space><cksum><term>
#    ~            01   xx           xx    CR

modelNumGet {
    out "~ \$Addr 01 %01<sum>";
    in "\$Addr OK 00 DIGITEL MPC";
} 

pressGet { 
    out "~ \$Addr 0B \$1 %01<sum>"; 
    in "\$Addr OK 00 %E Torr %00<sum>";
}

currGet {
    out "~ \$Addr 0A \$1 %01<sum>"; 
    in "\$Addr OK 00 %E Amps %00<sum>";
}

voltGet { 
    out "~ \$Addr 0C \$1 %01<sum>";
    in "\$Addr OK 00 %f %00<sum>";
}

supplyStatusGet { 
    out "~ \$Addr 0C \$1 %0<sum>"; 
    in "%s";
}

pumpStart { 
    out "~ \$Addr 37 \$1 %01<sum>"; 
    in "%s";
}

pumpStop { 
    out "~ \$Addr 38 \$1 %01<sum>"; 
    in "%s";
}

setPtSet { 
    out "~ \$Addr 38 \$1 %f %01<sum>"; 
    in "%s";
}

setPtGet { 
    out "~ \$Addr 3C \$1 %01<sum>"; 
    in "\$Addr OK 00 %d,%d,%(\$2:setPtOnGet.VAL)E,%(\$2:setPtOffGet.VAL)E,%(\$2:setPtStateGet.VAL)d %00<sum>";
}

